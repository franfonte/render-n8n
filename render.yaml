services:
  - type: web
    name: n8n-francisco
    plan: free
    runtime: image
    image:
      url: docker.io/n8nio/n8n:latest
    
    # Comando de inicio explícito para evitar errores
    startCommand: "n8n start"
    
    envVars:
      - key: PORT
        value: 5678
      
      # Render generará una clave segura automáticamente
      - key: N8N_ENCRYPTION_KEY
        generateValue: true

      # --- CONFIGURACIÓN DE SUPABASE ---
      - key: DB_TYPE
        value: postgresdb
      
      - key: DB_POSTGRESDB_PORT
        value: 5432
      
      - key: DB_POSTGRESDB_DATABASE
        value: postgres
      
      - key: DB_POSTGRESDB_USER
        value: postgres.tnlpjasyzkvqdzspawgj
      
      # --- SECRETOS (SEGUROS PARA GITHUB) ---
      # Al usar 'sync: false', Render te pedirá estos valores manualmente
      # en la pantalla de despliegue, así no quedan escritos en tu código.
      
      - key: DB_POSTGRESDB_HOST
        sync: false
      
      - key: DB_POSTGRESDB_PASSWORD
        sync: false
      
      # Opcional: Ayuda a que n8n arranque más rápido sin verificar migraciones innecesarias
      - key: N8N_SKIP_DB_CHECK
        value: true
